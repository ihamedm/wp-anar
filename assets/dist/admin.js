/*! For license information please see admin.js.LICENSE.txt */
(()=>{var e={736:function(e){var t;t=function(e){var t=function(e){return new t.lib.init(e)};function a(e,t){return t.offset[e]?isNaN(t.offset[e])?t.offset[e]:t.offset[e]+"px":"0px"}function o(e,t){return!(!e||"string"!=typeof t||!(e.className&&e.className.trim().split(/\s+/gi).indexOf(t)>-1))}return t.defaults={oldestFirst:!0,text:"Toastify is awesome!",node:void 0,duration:3e3,selector:void 0,callback:function(){},destination:void 0,newWindow:!1,close:!1,gravity:"toastify-top",positionLeft:!1,position:"",backgroundColor:"",avatar:"",className:"",stopOnFocus:!0,onClick:function(){},offset:{x:0,y:0},escapeMarkup:!0,ariaLive:"polite",style:{background:""}},t.lib=t.prototype={toastify:"1.12.0",constructor:t,init:function(e){return e||(e={}),this.options={},this.toastElement=null,this.options.text=e.text||t.defaults.text,this.options.node=e.node||t.defaults.node,this.options.duration=0===e.duration?0:e.duration||t.defaults.duration,this.options.selector=e.selector||t.defaults.selector,this.options.callback=e.callback||t.defaults.callback,this.options.destination=e.destination||t.defaults.destination,this.options.newWindow=e.newWindow||t.defaults.newWindow,this.options.close=e.close||t.defaults.close,this.options.gravity="bottom"===e.gravity?"toastify-bottom":t.defaults.gravity,this.options.positionLeft=e.positionLeft||t.defaults.positionLeft,this.options.position=e.position||t.defaults.position,this.options.backgroundColor=e.backgroundColor||t.defaults.backgroundColor,this.options.avatar=e.avatar||t.defaults.avatar,this.options.className=e.className||t.defaults.className,this.options.stopOnFocus=void 0===e.stopOnFocus?t.defaults.stopOnFocus:e.stopOnFocus,this.options.onClick=e.onClick||t.defaults.onClick,this.options.offset=e.offset||t.defaults.offset,this.options.escapeMarkup=void 0!==e.escapeMarkup?e.escapeMarkup:t.defaults.escapeMarkup,this.options.ariaLive=e.ariaLive||t.defaults.ariaLive,this.options.style=e.style||t.defaults.style,e.backgroundColor&&(this.options.style.background=e.backgroundColor),this},buildToast:function(){if(!this.options)throw"Toastify is not initialized";var e=document.createElement("div");for(var t in e.className="toastify on "+this.options.className,this.options.position?e.className+=" toastify-"+this.options.position:!0===this.options.positionLeft?(e.className+=" toastify-left",console.warn("Property `positionLeft` will be depreciated in further versions. Please use `position` instead.")):e.className+=" toastify-right",e.className+=" "+this.options.gravity,this.options.backgroundColor&&console.warn('DEPRECATION NOTICE: "backgroundColor" is being deprecated. Please use the "style.background" property.'),this.options.style)e.style[t]=this.options.style[t];if(this.options.ariaLive&&e.setAttribute("aria-live",this.options.ariaLive),this.options.node&&this.options.node.nodeType===Node.ELEMENT_NODE)e.appendChild(this.options.node);else if(this.options.escapeMarkup?e.innerText=this.options.text:e.innerHTML=this.options.text,""!==this.options.avatar){var o=document.createElement("img");o.src=this.options.avatar,o.className="toastify-avatar","left"==this.options.position||!0===this.options.positionLeft?e.appendChild(o):e.insertAdjacentElement("afterbegin",o)}if(!0===this.options.close){var n=document.createElement("button");n.type="button",n.setAttribute("aria-label","Close"),n.className="toast-close",n.innerHTML="&#10006;",n.addEventListener("click",function(e){e.stopPropagation(),this.removeElement(this.toastElement),window.clearTimeout(this.toastElement.timeOutValue)}.bind(this));var i=window.innerWidth>0?window.innerWidth:screen.width;("left"==this.options.position||!0===this.options.positionLeft)&&i>360?e.insertAdjacentElement("afterbegin",n):e.appendChild(n)}if(this.options.stopOnFocus&&this.options.duration>0){var s=this;e.addEventListener("mouseover",(function(t){window.clearTimeout(e.timeOutValue)})),e.addEventListener("mouseleave",(function(){e.timeOutValue=window.setTimeout((function(){s.removeElement(e)}),s.options.duration)}))}if(void 0!==this.options.destination&&e.addEventListener("click",function(e){e.stopPropagation(),!0===this.options.newWindow?window.open(this.options.destination,"_blank"):window.location=this.options.destination}.bind(this)),"function"==typeof this.options.onClick&&void 0===this.options.destination&&e.addEventListener("click",function(e){e.stopPropagation(),this.options.onClick()}.bind(this)),"object"==typeof this.options.offset){var r=a("x",this.options),c=a("y",this.options),l="left"==this.options.position?r:"-"+r,d="toastify-top"==this.options.gravity?c:"-"+c;e.style.transform="translate("+l+","+d+")"}return e},showToast:function(){var e;if(this.toastElement=this.buildToast(),!(e="string"==typeof this.options.selector?document.getElementById(this.options.selector):this.options.selector instanceof HTMLElement||"undefined"!=typeof ShadowRoot&&this.options.selector instanceof ShadowRoot?this.options.selector:document.body))throw"Root element is not defined";var a=t.defaults.oldestFirst?e.firstChild:e.lastChild;return e.insertBefore(this.toastElement,a),t.reposition(),this.options.duration>0&&(this.toastElement.timeOutValue=window.setTimeout(function(){this.removeElement(this.toastElement)}.bind(this),this.options.duration)),this},hideToast:function(){this.toastElement.timeOutValue&&clearTimeout(this.toastElement.timeOutValue),this.removeElement(this.toastElement)},removeElement:function(e){e.className=e.className.replace(" on",""),window.setTimeout(function(){this.options.node&&this.options.node.parentNode&&this.options.node.parentNode.removeChild(this.options.node),e.parentNode&&e.parentNode.removeChild(e),this.options.callback.call(e),t.reposition()}.bind(this),400)}},t.reposition=function(){for(var e,t={top:15,bottom:15},a={top:15,bottom:15},n={top:15,bottom:15},i=document.getElementsByClassName("toastify"),s=0;s<i.length;s++){e=!0===o(i[s],"toastify-top")?"toastify-top":"toastify-bottom";var r=i[s].offsetHeight;e=e.substr(9,e.length-1),(window.innerWidth>0?window.innerWidth:screen.width)<=360?(i[s].style[e]=n[e]+"px",n[e]+=r+15):!0===o(i[s],"toastify-left")?(i[s].style[e]=t[e]+"px",t[e]+=r+15):(i[s].style[e]=a[e]+"px",a[e]+=r+15)}return this},t.lib.init.prototype=t.lib,t},e.exports?e.exports=t():this.Toastify=t()}},t={};function a(o){var n=t[o];if(void 0!==n)return n.exports;var i=t[o]={exports:{}};return e[o].call(i.exports,i,i.exports,a),i.exports}a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var o in t)a.o(t,o)&&!a.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";var e,t,o=a(736),n=a.n(o);function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"error";null!=e&&n()({text:e,duration:5e3,newWindow:!0,close:!0,style:{background:"error"===t?"#cc3e3e":"success"===t?"#25ae25":"#373636"},gravity:"bottom",position:"left",stopOnFocus:!0}).showToast()}function s(e){return function(e){if(Array.isArray(e))return r(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return r(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?r(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}e=jQuery,t={move_to_step:function(e){var t=document.querySelectorAll(".step"),a=document.querySelectorAll(".step-title");t.forEach((function(t,a){a+1<=e?t.classList.add("active"):t.classList.remove("active")})),a.forEach((function(t,a){a+1==e?t.classList.add("activeTitle"):t.classList.remove("activeTitle")})),document.querySelectorAll(".stepContent").forEach((function(t,a){a+1===e?t.classList.add("active"):t.classList.remove("active")}));var o=2==e?85:86,n=(e-1)/(t.length-1)*o+"%";document.querySelector(".stepper-progress").style.width=n;var i=new URL(window.location),s=new URLSearchParams(i.search);s.set("step",e),i.search=s.toString(),window.history.replaceState({},"",i)},refreshData:function(){var e=jQuery("#refresh_anar_data");if(0!==e.length){var t=e.find(".data-item.categories"),a=e.find(".data-item.attributes");jQuery.ajax({url:awca_ajax_object.ajax_url,type:"POST",data:{action:"awca_get_categories_save_on_db_ajax"},success:function(e){e.success?(t.addClass("loaded"),jQuery.ajax({url:awca_ajax_object.ajax_url,type:"POST",data:{action:"awca_get_attributes_save_on_db_ajax"},success:function(e){e.success?(a.addClass("loaded"),i("همه اطلاعات دریافت شدند.","success"),setTimeout((function(){location.reload()}),2e3)):i(e.message,"error")},error:function(e,t,a){i(e.responseText)}})):i(e.message,"error")},error:function(e,t,a){i(e.responseText)}})}},moveToProperStep:function(){var e=new URLSearchParams(window.location.search).get("step");e&&!isNaN(e)&&t.move_to_step(parseInt(e))},fetchNotifications:function(e,t){var a=jQuery("#awca_notification_list");if(0!==a.length){var o=a.find(".spinner-loading"),n="error";jQuery.ajax({url:awca_ajax_object.ajax_url,type:"POST",dataType:"json",data:{action:"awca_fetch_notifications_ajax",page:e,limit:t},beforeSend:function(){o.show()},success:function(e){e.success&&(a.html(e.data.output),n="success",function(e,t,a){for(var o=jQuery("#awca_pagination"),n=Math.ceil(e/a),i="",s=1;s<=n;s++)i+='<button class="pagination-btn" data-page="'+s+'">'+s+"</button>";o.html(i),o.find(".pagination-btn").on("click",(function(){this.fetchNotifications(jQuery(this).data("page"),a)}))}(e.data.total,e.data.page,e.data.limit)),i(e.data.message,n)},error:function(e,t,a){i(e.responseText),o.hide()},complete:function(){o.hide()}})}},fetchPendingPayments:function(e,a){var o=jQuery("#awca_payments");if(0!==o.length){o.find(".spinner-loading");var n=o.find("#awca_payable"),s=o.find("#awca_payment_list"),r=o.find("#awca-loading-frame"),c="error";jQuery.ajax({url:awca_ajax_object.ajax_url,type:"POST",dataType:"json",data:{action:"awca_fetch_payments_ajax",page:e,limit:a},beforeSend:function(){r.show()},success:function(o){o.success&&(s.html(o.data.output),n.html(o.data.payable),function(e,a,o){var n=jQuery("#awca_pagination"),i=function(e){var t=e.current||1,a=e.total||1,o=e.base||"#page-%#%",n=e.prev_text||"&laquo;",i=e.next_text||"&raquo;",s="";t>1&&(s+='<a href="'+o.replace("%#%",t-1)+'" data-page="'+(t-1)+'">'+n+"</a>");for(var r=1;r<=a;r++)s+=r===t?'<span class="current">'+r+"</span>":'<a href="'+o.replace("%#%",r)+'" data-page="'+r+'">'+r+"</a>";return t<a&&(s+='<a href="'+o.replace("%#%",t+1)+'" data-page="'+(t+1)+'">'+i+"</a>"),s}({current:a,total:Math.ceil(e/o),base:"#page-%#%",format:"?page=%#%",prev_text:"&laquo;",next_text:"&raquo;"});n.html(i),n.find("a").on("click",(function(e){e.preventDefault();var a=jQuery(this).data("page");t.fetchPendingPayments(a,o)}))}(o.data.total,e,a),c="success"),i(o.data.message,c)},error:function(e,t,a){i(e.responseText),r.hide()},complete:function(){r.hide()}})}},clearSelect:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"varient",a=jQuery(".varient_selcet"),o=jQuery(".category_select"),n=jQuery(".clear-cat-icon"),i=jQuery(".clear-icon");"varient"!==t?(o[e].selectedIndex=0,n[e].style.display="none"):(a[e].selectedIndex=0,i[e].style.display="none")},changeCategorySelect:function(e,t){var a=jQuery(".clear-cat-icon");"0"!==e.value?a[t].style.display="block":a[t].style.display="none"}},e(document).ready((function(){jQuery("#plugin_sync_form").on("submit",(function(e){e.preventDefault();var t=jQuery(this),a=t.find(".spinner-loading"),o=t.find("#full_sync");jQuery.ajax({url:t.attr("action"),type:"POST",dataType:"json",timeout:2e6,data:t.serialize(),beforeSend:function(){a.show(),o.is(":checked")&&(i("همگام سازی کل محصولات اندکی زمان بر خواهد بود و در پس زمینه انجام می شود.","success"),a.hide())},success:function(e){e.success?i(e.message,"success"):i(e.message,"error")},error:function(e,t,o){a.hide(),i(e.responseText)},complete:function(){a.hide()}})})),jQuery("#plugin_activation_form").on("submit",(function(e){e.preventDefault();var t=jQuery(this);jQuery.ajax({url:t.attr("action"),type:"POST",dataType:"json",data:t.serialize(),beforeSend:function(){jQuery(".spinner-loading").show()},success:function(e){e.success?(i(e.message,"success"),window.location.reload()):(i(e.message,"error"),e.activation_status&&i(e.message,"success"))},error:function(e,t,a){jQuery(".spinner-loading").hide(),i(e.responseText)},complete:function(){jQuery(".spinner-loading").hide()}})})),jQuery("#plugin_category_creation_form").on("submit",(function(e){e.preventDefault();var a=jQuery(this);jQuery.ajax({url:a.attr("action"),type:"POST",data:a.serialize(),beforeSend:function(){jQuery(".spinner-loading").show(),jQuery(".configuration_save_button").attr("disabled","disabled")},success:function(e){e.success&&(i(e.message,"success"),t.move_to_step(3))},error:function(e,t,a){i(e.responseText),jQuery(".spinner-loading").hide(),jQuery(".configuration_save_button").removeAttr("disabled")},complete:function(){jQuery(".spinner-loading").hide(),jQuery(".configuration_save_button").removeAttr("disabled")}})})),jQuery("#plugin_attribute_creation_form").on("submit",(function(e){e.preventDefault();var a=jQuery(this);jQuery.ajax({url:a.attr("action"),type:"POST",dataType:"json",data:a.serialize(),beforeSend:function(){jQuery(".spinner-loading").show(),jQuery(".configuration_save_button").attr("disabled","disabled")},success:function(e){e.success&&(i(e.message,"success"),t.move_to_step(4))},error:function(e,t,a){i(e.responseText),jQuery(".spinner-loading").hide(),jQuery(".configuration_save_button").removeAttr("disabled")},complete:function(){jQuery(".spinner-loading").hide(),jQuery(".configuration_save_button").removeAttr("disabled")}})})),jQuery("#awca-dl-the-product-images").on("click",(function(t){t.preventDefault();var a=e(this).find(".spinner-loading"),o=e(this).data("product-id"),n="error";jQuery.ajax({url:awca_ajax_object.ajax_url,type:"POST",dataType:"json",data:{product_id:o,action:"awca_dl_the_product_images_ajax"},beforeSend:function(){a.show(),e(this).attr("disabled","disabled")},success:function(e){e.success&&(location.reload(),n="success"),i(e.data.message,n)},error:function(t,o,n){i("حطایی در برقراری ارتباط پیش آمده است."),a.hide(),e(this).removeAttr("disabled")},complete:function(){a.hide(),e(this).removeAttr("disabled")}})})),jQuery("#get-save-categories-btn").on("click",(function(t){t.preventDefault(),e.ajax({url:awca_ajax_object.ajax_url,type:"POST",data:{action:"awca_get_categories_save_on_db_ajax"},beforeSend:function(){e(".spinner-loading").show(),e("#get-save-categories-btn").attr("disabled","disabled")},success:function(e){e.success?(i(e.message,"success"),location.reload()):i(e.message,"error")},error:function(t,a,o){e(".spinner-loading").hide(),e("#get-save-categories-btn").removeAttr("disabled"),i(t.responseText)},complete:function(){e(".spinner-loading").hide(),e("#get-save-categories-btn").removeAttr("disabled")}})})),jQuery("#get-save-attributes-btn").on("click",(function(t){t.preventDefault();var a=e(this).find(".spinner-loading");e.ajax({url:awca_ajax_object.ajax_url,type:"POST",data:{action:"awca_get_attributes_save_on_db_ajax"},beforeSend:function(){a.show(),e(this).attr("disabled","disabled")},success:function(e){e.success?(i(e.message,"success"),location.reload()):i(e.message,"error")},error:function(t,o,n){a.hide(),e(this).removeAttr("disabled"),i(t.responseText)},complete:function(){a.hide(),e(this).removeAttr("disabled")}})})),e("#handle-bg-process a").on("click",(function(t){t.preventDefault();var a=e(this).data("action");e.ajax({url:awca_ajax_object.ajax_url,type:"POST",data:{action:"handle_process_actions",process_action:a},success:function(e){i("با موفقیت انجام شد.","success")},error:function(e,t,a){i("مشکلی بوجود آمده. خطا: "+a,"error")}})})),e("[data-next-step]").on("click",(function(){t.move_to_step(e(this).data("next-step"))})),e(".awca-faq").on("click",".faq-question",(function(t){t.preventDefault(),e(this).parents(".faq-item").toggleClass("active")})),e(".toggle_show_hide").on("click",(function(t){t.preventDefault();var a=e(this).data("id");e("#"+a).toggle()})),t.fetchNotifications(1,10),t.fetchPendingPayments(1,10),t.refreshData(),t.moveToProperStep()})),jQuery(document).ready((function(e){var t,a,o,n,s,r;t=e("#awca-dl-all-product-gallery-images"),a=t.find(".spinner-loading"),o=t.find(".awca_ajax-result"),n=t.find(".awca_ajax-result-progress"),s=t.find("#dl_product_g_imgs_btn"),r=t.find(".process-controllers"),0!==t.length&&(t.on("submit",(function(t){t.preventDefault();var n="error",r=1,c=0;!function t(){e.ajax({url:awca_ajax_object.ajax_url,type:"POST",dataType:"json",data:{action:"awca_run_dl_product_gallery_images_bg_process_ajax",paged:r},beforeSend:function(){a.show(),s.attr("disabled","disabled")},success:function(e){if(e.success){if(n="success",(c+=e.data.queued_products)>0){var l=c+" محصول به صف دانلود تصاویر گالری اضافه شد.";o.addClass("success").text(l)}e.data.finished?(a.hide(),i(e.data.message,n),setInterval((function(){location.reload()}),1e3)):(r=e.data.next_paged,t())}else a.hide(),s.removeAttr("disabled"),i(e.data.message,n)},error:function(e,t,o){a.hide(),s.removeAttr("disabled"),i(e.responseText)},complete:function(){}})}()})),0!==r.length&&(setInterval((function(){e.ajax({url:awca_ajax_object.ajax_url,type:"POST",dataType:"json",data:{action:"awca_dl_product_gallery_images_bg_process_data_ajax"},beforeSend:function(){},success:function(e){if(e.success)if("processing"===e.data.process_status||"queued"===e.data.process_status){var a=e.data.processed_products,o=e.data.queued_products,s=e.data.total_products;console.log(a+" of total:"+s+"queued:"+o);var r=Math.ceil(100*a/s);if(n.show(),r<=100){n.find(".bar").animate({width:r+"%"},500);var c=r+"%";t.find(".process_data_message").text(c)}}else i("دریافت تصاویر با موفقیت به اتمام رسید.","success"),setInterval((function(){location.reload()}),2e3);else console.log(e)},error:function(e,t,a){i(e.responseText)},complete:function(){}})}),2e3),r.find("a").on("click",(function(t){t.preventDefault();var a=e(this).data("action");e.ajax({url:awca_ajax_object.ajax_url,type:"POST",data:{action:"awca_handle_dl_product_gallery_images_process_actions",process_action:a},success:function(t){e(this).hide(),e(this).hasClass("pause")?r.find(".resume").show():e(this).hasClass("resume")?r.find(".pause").show():e(this).hasClass("cancel")&&location.reload(),i("عملیات با موفقیت انجام شد.","success")},error:function(e,t,a){console.log("xhr:",e),console.log("status:",t),i("مشکلی در انجام درخواست شما بوجود آمد. خطا: "+a,"error")}})}))))}));var c,l,d,u,f,p=(c=["a[href]","area[href]",'input:not([disabled]):not([type="hidden"]):not([aria-hidden])',"select:not([disabled]):not([aria-hidden])","textarea:not([disabled]):not([aria-hidden])","button:not([disabled]):not([aria-hidden])","iframe","object","embed","[contenteditable]",'[tabindex]:not([tabindex^="-"])'],l=function(){function e(t){var a=t.targetModal,o=t.triggers,n=void 0===o?[]:o,i=t.onShow,r=void 0===i?function(){}:i,c=t.onClose,l=void 0===c?function(){}:c,d=t.openTrigger,u=void 0===d?"data-micromodal-trigger":d,f=t.closeTrigger,p=void 0===f?"data-micromodal-close":f,h=t.openClass,m=void 0===h?"is-open":h,v=t.disableScroll,b=void 0!==v&&v,g=t.disableFocus,y=void 0!==g&&g,_=t.awaitCloseAnimation,j=void 0!==_&&_,w=t.awaitOpenAnimation,x=void 0!==w&&w,O=t.debugMode,S=void 0!==O&&O;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.modal=document.getElementById(a),this.config={debugMode:S,disableScroll:b,openTrigger:u,closeTrigger:p,openClass:m,onShow:r,onClose:l,awaitCloseAnimation:j,awaitOpenAnimation:x,disableFocus:y},n.length>0&&this.registerTriggers.apply(this,s(n)),this.onClick=this.onClick.bind(this),this.onKeydown=this.onKeydown.bind(this)}var t;return(t=[{key:"registerTriggers",value:function(){for(var e=this,t=arguments.length,a=new Array(t),o=0;o<t;o++)a[o]=arguments[o];a.filter(Boolean).forEach((function(t){t.addEventListener("click",(function(t){return e.showModal(t)}))}))}},{key:"showModal",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.activeElement=document.activeElement,this.modal.setAttribute("aria-hidden","false"),this.modal.classList.add(this.config.openClass),this.scrollBehaviour("disable"),this.addEventListeners(),this.config.awaitOpenAnimation?this.modal.addEventListener("animationend",(function t(){e.modal.removeEventListener("animationend",t,!1),e.setFocusToFirstNode()}),!1):this.setFocusToFirstNode(),this.config.onShow(this.modal,this.activeElement,t)}},{key:"closeModal",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.modal;if(this.modal.setAttribute("aria-hidden","true"),this.removeEventListeners(),this.scrollBehaviour("enable"),this.activeElement&&this.activeElement.focus&&this.activeElement.focus(),this.config.onClose(this.modal,this.activeElement,e),this.config.awaitCloseAnimation){var a=this.config.openClass;this.modal.addEventListener("animationend",(function e(){t.classList.remove(a),t.removeEventListener("animationend",e,!1)}),!1)}else t.classList.remove(this.config.openClass)}},{key:"closeModalById",value:function(e){this.modal=document.getElementById(e),this.modal&&this.closeModal()}},{key:"scrollBehaviour",value:function(e){if(this.config.disableScroll){var t=document.querySelector("body");switch(e){case"enable":Object.assign(t.style,{overflow:""});break;case"disable":Object.assign(t.style,{overflow:"hidden"})}}}},{key:"addEventListeners",value:function(){this.modal.addEventListener("touchstart",this.onClick),this.modal.addEventListener("click",this.onClick),document.addEventListener("keydown",this.onKeydown)}},{key:"removeEventListeners",value:function(){this.modal.removeEventListener("touchstart",this.onClick),this.modal.removeEventListener("click",this.onClick),document.removeEventListener("keydown",this.onKeydown)}},{key:"onClick",value:function(e){(e.target.hasAttribute(this.config.closeTrigger)||e.target.parentNode.hasAttribute(this.config.closeTrigger))&&(e.preventDefault(),e.stopPropagation(),this.closeModal(e))}},{key:"onKeydown",value:function(e){27===e.keyCode&&this.closeModal(e),9===e.keyCode&&this.retainFocus(e)}},{key:"getFocusableNodes",value:function(){var e=this.modal.querySelectorAll(c);return Array.apply(void 0,s(e))}},{key:"setFocusToFirstNode",value:function(){var e=this;if(!this.config.disableFocus){var t=this.getFocusableNodes();if(0!==t.length){var a=t.filter((function(t){return!t.hasAttribute(e.config.closeTrigger)}));a.length>0&&a[0].focus(),0===a.length&&t[0].focus()}}}},{key:"retainFocus",value:function(e){var t=this.getFocusableNodes();if(0!==t.length)if(t=t.filter((function(e){return null!==e.offsetParent})),this.modal.contains(document.activeElement)){var a=t.indexOf(document.activeElement);e.shiftKey&&0===a&&(t[t.length-1].focus(),e.preventDefault()),!e.shiftKey&&t.length>0&&a===t.length-1&&(t[0].focus(),e.preventDefault())}else t[0].focus()}}])&&function(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}(e.prototype,t),e}(),d=null,u=function(e){if(!document.getElementById(e))return console.warn("MicroModal: ❗Seems like you have missed %c'".concat(e,"'"),"background-color: #f8f9fa;color: #50596c;font-weight: bold;","ID somewhere in your code. Refer example below to resolve it."),console.warn("%cExample:","background-color: #f8f9fa;color: #50596c;font-weight: bold;",'<div class="modal" id="'.concat(e,'"></div>')),!1},f=function(e,t){if(function(e){e.length<=0&&(console.warn("MicroModal: ❗Please specify at least one %c'micromodal-trigger'","background-color: #f8f9fa;color: #50596c;font-weight: bold;","data attribute."),console.warn("%cExample:","background-color: #f8f9fa;color: #50596c;font-weight: bold;",'<a href="#" data-micromodal-trigger="my-modal"></a>'))}(e),!t)return!0;for(var a in t)u(a);return!0},{init:function(e){var t=Object.assign({},{openTrigger:"data-micromodal-trigger"},e),a=s(document.querySelectorAll("[".concat(t.openTrigger,"]"))),o=function(e,t){var a=[];return e.forEach((function(e){var o=e.attributes[t].value;void 0===a[o]&&(a[o]=[]),a[o].push(e)})),a}(a,t.openTrigger);if(!0!==t.debugMode||!1!==f(a,o))for(var n in o){var i=o[n];t.targetModal=n,t.triggers=s(i),d=new l(t)}},show:function(e,t){var a=t||{};a.targetModal=e,!0===a.debugMode&&!1===u(e)||(d&&d.removeEventListeners(),(d=new l(a)).showModal())},close:function(e){e?d.closeModalById(e):d.closeModal()}});"undefined"!=typeof window&&(window.MicroModal=p);const h=p;function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}function v(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,o)}return a}function b(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?v(Object(a),!0).forEach((function(t){g(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):v(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function g(e,t,a){return(t=function(e){var t=function(e){if("object"!=m(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,"string");if("object"!=m(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==m(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}function _(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,o)}return a}function j(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?_(Object(a),!0).forEach((function(t){w(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):_(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function w(e,t,a){return(t=function(e){var t=function(e){if("object"!=y(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,"string");if("object"!=y(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==y(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function x(e){return x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},x(e)}function O(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,o)}return a}function S(e,t,a){return(t=function(e){var t=function(e){if("object"!=x(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,"string");if("object"!=x(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==x(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function T(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var o,n,i,s,r=[],c=!0,l=!1;try{if(i=(a=a.call(e)).next,0===t){if(Object(a)!==a)return;c=!1}else for(;!(c=(o=i.call(a)).done)&&(r.push(o.value),r.length!==t);c=!0);}catch(e){l=!0,n=e}finally{try{if(!c&&null!=a.return&&(s=a.return(),Object(s)!==s))return}finally{if(l)throw n}}return r}}(e,t)||function(e,t){if(e){if("string"==typeof e)return k(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?k(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,o=Array(t);a<t;a++)o[a]=e[a];return o}h.init({openTrigger:"data-payment-modal-open"}),jQuery(document).ready((function(e){var t=e("#awca-create-anar-order");0!==t.length&&t.on("click",(function(t){t.preventDefault();var a=e(this).find(".spinner-loading"),o=e(this).data("order-id"),n="error";jQuery.ajax({url:awca_ajax_object.ajax_url,type:"POST",dataType:"json",data:{order_id:o,action:"awca_create_anar_order_ajax"},beforeSend:function(){a.show(),e(this).attr("disabled","disabled")},success:function(e){e.success&&(location.reload(),n="success"),i(e.data.message,n)},error:function(t,o,n){i(t.responseText),a.hide(),e(this).removeAttr("disabled")},complete:function(){a.hide(),e(this).removeAttr("disabled")}})}));var a=e("#anar-order-details");if(0!==a.length){var o=a.find(".spinner-loading"),n=a.data("order-id"),s="error";jQuery.ajax({url:awca_ajax_object.ajax_url,type:"POST",dataType:"json",data:{order_id:n,action:"awca_fetch_order_details_ajax"},beforeSend:function(){o.show()},success:function(e){e.success&&(a.html(e.data.output),s="success"),i(e.data.message,s),"unpaid"==e.data.paymentStatus&&h.show("order-payment-modal")},error:function(e,t,a){i(e.responseText),o.hide()},complete:function(){o.hide()}})}e(document).on("click",".anar-package-data header",(function(t){t.preventDefault(),e(this).parent("div").toggleClass("open")}))})),jQuery(document).ready((function(e){var t=e(".awca_product_list_table");if(0!==t.length){var a=function(a){t.find("tbody").html("\n            ".concat('<tr class="placeholder"><td>—</td><td><div class="placeholder-image"></div></td><td><div class="placeholder-text"></div></td><td><div class="placeholder-text"></div></td><td><div class="placeholder-text"></div></td><td><div class="placeholder-text"></div></td><td><div class="placeholder-text"></div></td><td><div class="placeholder-text"></div></td></tr>'.repeat(10),"\n        ")),n=a,e.ajax({url:awca_ajax_object.ajax_url,type:"GET",data:{action:"awca_fetch_products_paginate_ajax",page:a},success:function(r){if(r.success){var c=r.data.items,l=t.find(".list"),d="";e.each(c,(function(e,t){var a;d+='<tr class="item">',d+="<td>"+((n-1)*s+(e+1))+"</td>",d+='<td><img class="awca_product_images" src="'+(t.mainImage?t.mainImage:"")+'" alt="'+t.title+'"></td>',d+='<td class="awca_product_title">'+t.title+"</td>",d+='<td style="cursor: pointer;" >'+function(e){if(!e)return e;var t=e.replace(/<\/?[^>]+>/gi,"").trim().split(/\s+/);return t.length>0?t.slice(0,20).join(" "):e}(null!==(a=t.description)&&void 0!==a?a:"")+"...</td>",d+='<td style="cursor: pointer;" >مشاهده</td>',d+='<td class="awca_product_price">'+t.variants[0].priceForResell+" تومان</td>",d+='<td class="awca_product_price">'+t.variants[0].price+" تومان</td>",d+='<td style="cursor: pointer;" onclick="awca_complete_desc(\''+JSON.stringify(t.shipments)+"', 'روش‌های ارسال محصول')\">مشاهده</td>",d+="</tr>"})),l.html(d),i=Math.ceil(r.data.total/s),e("#current-page").text(a),e("#prev-page").prop("disabled",1===a),e("#next-page").prop("disabled",0===c.length),o(a,i)}else console.log(r.data)},error:function(e){console.log(e)}})},o=function(t,o){var n=e("#pagination-numbers");if(n.empty(),t>1){var i=e('<li class="prev">قبلی</li>');i.click((function(){a(t-1)})),n.append(i)}if(o<=6)for(var s=1;s<=o;s++){var r=e("<li>"+s+"</li>");s===t&&r.addClass("active"),r.click(function(e){return function(){a(e)}}(s)),n.append(r)}else{for(s=1;s<=2;s++)r=e("<li>"+s+"</li>"),s===t&&r.addClass("active"),r.click(function(e){return function(){a(e)}}(s)),n.append(r);for(t>4&&n.append('<li class="dots">...</li>'),s=Math.max(3,t-1);s<=Math.min(o-2,t+1);s++)s>2&&s<o-1&&(r=e("<li>"+s+"</li>"),s===t&&r.addClass("active"),r.click(function(e){return function(){a(e)}}(s)),n.append(r));for(t<o-3&&n.append('<li class="dots">...</li>'),s=o-1;s<=o;s++)r=e("<li>"+s+"</li>"),s===t&&r.addClass("active"),r.click(function(e){return function(){a(e)}}(s)),n.append(r)}if(t<o){var c=e('<li class="next">بعدی</li>');c.click((function(){a(t+1)})),n.append(c)}},n=1,i=1,s=10;e("#prev-page").click((function(){n>1&&(n--,a(n))})),e("#next-page").click((function(){n++,a(n)})),a(n)}})),jQuery(document).ready((function(e){var t=e("#get-save-products-btn"),a=!1;0!==t.length&&(t.on("click",(function(o){o.preventDefault();var n=e(this).find(".spinner-loading"),s=e(this).next(".awca_step-ajax-result"),r=e(this).parent(".awca-save-products-wrapper").find(".awca_step-ajax-result-progress"),c=0,l=0,d=0,u=!0;a=!0,function o(f){e.ajax({url:awca_ajax_object.ajax_url,type:"POST",data:{action:"awca_get_products_save_on_db_ajax",page:f},beforeSend:function(){n.show(),t.attr("disabled","disabled")},success:function(e){if(e.success){l+=e.total_added,d=e.total_products;var c=100*l/d+"%";r.show(),r.find(".bar").animate({width:c},500);var p=l+" محصول از کل "+d+" دریافت شد";s.addClass("success").text(p),(u=e.has_more)?o(f+1):(n.hide(),s.append('<p style="font-weight:bold;">همه محصولات انار دریافت شد. ساخت محصولات در پس زمینه انجام می شود. می توانید این صفحه را ببندید.</p>'),i("کل محصولات انار دریافت شد.","success"),a=!1)}else s.addClass("error").text(e.message),i(e.message,"error"),n.hide(),t.removeAttr("disabled"),a=!1},error:function(e,r,l){c<10?(i("ارتباط قطع شد. تلاش مجدد ... ("+ ++c+"/10)"),o(f)):(n.hide(),t.removeAttr("disabled"),s.addClass("error").text("ارتباط پس از 10 تلاش مجدد قطع شد!"),a=!1)},complete:function(){u||n.hide()}})}(1)})),window.addEventListener("beforeunload",(function(e){if(a){var t="در صورت بستن یا باگزاری مجدد دریافت اطلاعات از انار قطع می شود. مطمئنید؟";return(e||window.event).returnValue=t,t}}))),e("#start_bg_process_products").on("click",(function(t){t.preventDefault(),e.ajax({url:awca_ajax_object.ajax_url,type:"POST",data:{action:"awca_run_product_creation_background_process_ajax",nonce:awca_ajax_object.nonce},success:function(e){i("ساخت محصولات در پس زمینه شروع شد.","success")},error:function(e,t,a){i("مشکلی در شروع فرآیند پس زمینه ایجاد شد.","error")}})}))})),jQuery(document).ready((function(e){var t,a,o;t=e("#awca-reset-all-settings"),a=t.find(".spinner-loading"),o=t.find("#awca_reset_options_btn"),0!==t.length&&t.on("submit",(function(n){n.preventDefault();var s="error";e.ajax({url:awca_ajax_object.ajax_url,type:"POST",dataType:"json",data:{action:"awca_reset_all_settings_ajax",delete_maps:t.find("#delete_map_data").prop("checked")},beforeSend:function(){a.show(),o.attr("disabled","disabled")},success:function(e){e.success?(s="success",i(e.data.message,s)):(a.hide(),o.removeAttr("disabled"),i(e.data.message,s))},error:function(e,t,n){a.hide(),o.removeAttr("disabled"),i(e.responseText)},complete:function(){a.hide(),o.removeAttr("disabled")}})}))})),jQuery(document).ready((function(e){var t;0!==(t=e("#publish-anar-products")).length&&t.on("submit",(function(a){a.preventDefault();var o=t.find(".submit-button"),n=o.find(".spinner-loading"),s=t.find(".anar-batch-progress"),r=t.find(".anar-batch-messages"),c=0,l=0,d="error";!function a(u){e.ajax({url:awca_ajax_object.ajax_url,type:"POST",dataType:"json",data:{action:"awca_publish_draft_products_ajax",page:u,limit:100,security_nonce:t.find('input[name="security_nonce"]').val(),skipp_out_of_stocks:t.find('input[name="skipp_out_of_stocks"]').prop("checked")},beforeSend:function(){n.show(),s.show(),r.show(),o.attr("disabled","disabled")},success:function(e){if(e.success){d="success",c+=e.loop_products,1===u&&(l=e.found_products);var t=(c/l*100).toFixed(2)+"%";s.show(),s.find(".bar").animate({width:t},500);var f=c+" محصول از کل "+l+" پردازش شد";r.addClass("success").text(f),e.has_more?a(u+1):(r.addClass("success").text("همه محصولات پردازش شدند"),i("همه محصولات پردازش شدند","success"))}else r.addClass("error").text(e.message),n.hide(),o.removeAttr("disabled"),i(e.message,d)},error:function(e,t,a){n.hide(),o.removeAttr("disabled"),i(e.responseText)},complete:function(){n.hide(),o.removeAttr("disabled")}})}(1)}))})),jQuery(document).ready((function(e){e(".anar-tool-ajax-form").each((function(){var t=e(this),a=t.find(".spinner-loading"),o=t.find(".tool_submit_btn");t.on("submit",(function(n){n.preventDefault();var s=t.serializeArray(),r={};t.find("input, select, textarea").each((function(){var t=e(this);t.attr("name")&&!t.prop("disabled")&&(r[t.attr("name")]=t.val())}));var c=b(b({action:t.find('input[name="action"]').val()||""},Object.fromEntries(s.map((function(e){return[e.name,e.value]})))),r);e.ajax({url:awca_ajax_object.ajax_url,type:"POST",dataType:"json",data:c,beforeSend:function(){a.show(),o.attr("disabled","disabled")},success:function(e){var a=e.success?"success":"error";t.trigger("awca_ajax_form_success",[e,a]),e.data&&e.data.message&&i(e.data.message,a),e.success&&t[0].reset()},error:function(e,a,o){t.trigger("awca_ajax_form_error",[e,a,o]),i(e.responseText||"An error occurred","error")},complete:function(){a.hide(),o.removeAttr("disabled")}})}))})),e(".access-menu").on("click",".access-menu-toggle",(function(t){t.preventDefault(),e(this).siblings("ul").toggle()}))})),jQuery(document).ready((function(e){var t,a,o;t=e("#anar_tools_not_sync_form"),a=t.find("#submit-form-btn"),o=e("#anar_tools_sync_outdated"),0!==t.length&&t.on("submit",(function(n){n.preventDefault();var s="error",r=t.serializeArray(),c={};t.find("input, select, textarea").each((function(){var t=e(this);t.attr("name")&&!t.prop("disabled")&&(c[t.attr("name")]=t.val())}));var l=j(j({action:t.find('input[name="action"]').val()||""},Object.fromEntries(r.map((function(e){return[e.name,e.value]})))),c);e.ajax({url:awca_ajax_object.ajax_url,type:"POST",dataType:"json",data:l,beforeSend:function(){a.addClass("loading"),a.attr("disabled","disabled")},success:function(e){e.success&&(s="success"),e.data.found_posts>0&&o.show(),t.find(".form-results").show().html(e.data.message),i(e.data.toast,s)},error:function(e,t,a){i(e.responseText)},complete:function(){a.removeClass("loading"),a.removeAttr("disabled")}})}))})),jQuery(document).ready((function(e){var t,a=e("#anar-system-reports"),o=e("#anar-download-system-report"),n=e("#anar-show-system-report"),s="",r=!1;o.prop("disabled",!0),n.prop("disabled",!0),o.on("click",(function(){if(s){var e=new Date,t="system-report-".concat(e.getFullYear(),"-").concat(String(e.getMonth()+1).padStart(2,"0"),"-").concat(String(e.getDate()).padStart(2,"0"),"-").concat(String(e.getHours()).padStart(2,"0")).concat(String(e.getMinutes()).padStart(2,"0"),".txt"),a=new Blob([s],{type:"text/plain;charset=utf-8"});if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(a,t);else{var o=document.createElement("a");o.href=URL.createObjectURL(a),o.download=t,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(o.href)}i("فایل گزارش با موفقیت دانلود شد","success")}else i("اطلاعاتی برای دانلود وجود ندارد","error")})),n.on("click",(function(){(r=!r)?(a.slideDown(300),n.text("پنهان کردن گزارش")):(a.slideUp(300),n.text("نمایش گزارش"))})),t=a.data("action"),0!==a.length&&e.ajax({url:awca_ajax_object.ajax_url,type:"POST",dataType:"json",data:{action:t},beforeSend:function(){i("در حال دریافت اطلاعات","success"),a.val("در حال دریافت اطلاعات..."),o.prop("disabled",!0),n.prop("disabled",!0)},success:function(e){var t=e.success?"success":"error";e.data&&(e.data.toast&&i(e.data.toast,t),s=e.data.text_report,a.val(s),e.data.table_data&&function(e){var t=document.getElementById("anar-system-reports-table"),a={};Object.entries(e).forEach((function(e){var t=T(e,2),o=t[0],n=t[1];a[n.group]||(a[n.group]=[]),a[n.group].push(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?O(Object(a),!0).forEach((function(t){S(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):O(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({key:o},n))}));var o=Object.entries(a).map((function(e){var t=T(e,2),a=t[0],o=t[1];return'\n            <div class="anar-report-group">\n                <h3>'.concat(a,'</h3>\n                <table class="anar-report-table">\n                    <tbody>\n                        ').concat(o.map((function(e){return"\n                            <tr>\n                                <td>".concat(e.label,"</td>\n                                <td>\n                                    ").concat((t=e.status,{good:'<span class="status-icon status-good dashicons dashicons-yes-alt"></span>',warning:'<span class="status-icon status-warning dashicons dashicons-warning"></span>',critical:'<span class="status-icon status-critical dashicons dashicons-dismiss"></span>'}[t]||""),"\n                                    ").concat(e.is_link?'<a href="'.concat(e.url,'" class="report-link" target="_blank">\n                                             ').concat(e.value,'\n                                             <span class="dashicons dashicons-external"></span>\n                                           </a>'):e.value,"\n                                </td>\n                            </tr>\n                        ");var t})).join(""),"\n                    </tbody>\n                </table>\n            </div>\n        ")})).join("");t.innerHTML=o}(e.data.table_data),o.prop("disabled",!1),n.prop("disabled",!1))},error:function(e,t,s){i(e.responseText||"خطا در دریافت اطلاعات","error"),a.val("خطا در دریافت اطلاعات. لطفا مجددا تلاش کنید."),o.prop("disabled",!0),n.prop("disabled",!0),r=!1,a.hide(),n.text("نمایش گزارش")}})})),jQuery(document).ready((function(e){var t=e("#anar_force_sync_products"),a=e("#submit-form-btn"),o=e("#clear-sync-times-btn"),n=a.find(".spinner-loading"),s=null,r=!1;function c(){n.hide(),a.prop("disabled",!1)}function l(e){i(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success")}function d(){s&&(clearInterval(s),s=null)}t.on("submit",(function(t){if(t.preventDefault(),console.log("Form submitted"),a.prop("disabled"))l("یک بروزرسانی در حال اجراست. لطفا صبر کنید.","error");else{n.show(),a.prop("disabled",!0),a.text("شروع بروزرسانی...");var o={action:"anar_force_sync_products",security_nonce:e("#security_nonce").val()};console.log("Sending AJAX request with data:",o),e.ajax({url:ajaxurl,type:"POST",data:o,beforeSend:function(){console.log("AJAX request starting...")},success:function(e){console.log("AJAX response received:",e),e.success?(console.log("Success response received"),e.data.job_id,a.text("در حال بروزرسانی..."),a.prop("disabled",!0),console.log("Button disabled"),l("بروزرسانی با موفقیت شروع شد"),console.log("Toast shown"),r=!0,console.log("Setting isReloading to true"),console.log("Scheduling page reload..."),setTimeout((function(){console.log("Executing page reload..."),window.location.reload()}),1e3)):(console.log("Error response received:",e),c(),l(e.data.message,"error"),a.text("بروزرسانی اجباری کل محصولات"))},error:function(e,t,o){console.log("AJAX error:",{xhr:e,status:t,error:o}),c(),l("خطا در ارسال درخواست","error"),a.text("بروزرسانی اجباری کل محصولات")}})}})),e(document).on("click",".job-control-btn",(function(){var t,a;t=e(this).data("action"),a=e(this).data("job-id"),e.ajax({url:ajaxurl,type:"POST",data:{action:"anar_control_sync_job",job_id:a,action_type:t,security_nonce:e("#security_nonce").val()},success:function(e){e.success?(l(e.data.message),window.location.reload()):l(e.data.message,"error")},error:function(){l("خطا در اجرای عملیات","error")}})})),function(){console.log("Form initialized"),n.hide();var t,i=!0===a.data("has-active-job");if(a.prop("disabled",i),i){var u=e(".active-job-container").data("job-id");u&&(t=u,d(),s=setInterval((function(){return function(t){e.ajax({url:ajaxurl,type:"POST",data:{action:"anar_get_job_status",job_id:t,security_nonce:e("#security_nonce").val()},success:function(t){var o,n,i,s,u,f;t.success?(n=(o=t.data).status,i=o.progress,s=e(".job-progress-bar"),u=e(".job-progress-info span:last-child"),f=Math.round(i.processed/i.total*100),s.css("width","".concat(f,"%")),u.text("".concat(i.processed,"/").concat(i.total)),e(".job-status").text(function(e){return{pending:"در انتظار",in_progress:"در حال اجرا",completed:"تکمیل شده",failed:"ناموفق",cancelled:"لغو شده",paused:"متوقف شده"}[e]||e}(n)),"in_progress"===n?(a.text("در حال بروزرسانی (".concat(i.processed,"/").concat(i.total,")")),a.prop("disabled",!0)):"completed"!==n||r?"failed"!==n||r?"cancelled"!==n||r||(a.text("بروزرسانی اجباری کل محصولات"),l("بروزرسانی لغو شد"),d(),c(),r=!0,setTimeout((function(){return window.location.reload()}),2e3)):(a.text("بروزرسانی اجباری کل محصولات"),l("خطا در بروزرسانی: "+(o.error_log||"خطای ناشناخته"),"error"),d(),c(),r=!0,setTimeout((function(){return window.location.reload()}),2e3)):(a.text("بروزرسانی اجباری کل محصولات"),l("بروزرسانی با موفقیت انجام شد"),d(),c(),r=!0,setTimeout((function(){return window.location.reload()}),2e3)),t.data.completed&&d()):(l(t.data.message,"error"),d())},error:function(){l("Error checking job status","error"),d()}})}(t)}),1e4))}o.length&&o.on("click",(function(t){t.preventDefault(),confirm("آیا از پاک کردن زمان‌های بروزرسانی اطمینان دارید؟ این کار باعث بروزرسانی مجدد تمام محصولات خواهد شد.")&&(o.prop("disabled",!0),o.text("در حال پاک کردن..."),e.ajax({url:ajaxurl,type:"POST",data:{action:"anar_clear_sync_times",security_nonce:e("#security_nonce").val()},success:function(e){e.success?(l(e.data.message),setTimeout((function(){return window.location.reload()}),2e3)):(l(e.data.message,"error"),o.prop("disabled",!1),o.text("پاک کردن زمان‌های بروزرسانی"))},error:function(){l("خطا در ارسال درخواست","error"),o.prop("disabled",!1),o.text("پاک کردن زمان‌های بروزرسانی")}}))}))}()})),jQuery(document).ready((function(e){var t=e("#anar-dl-products-gallery"),a=t.find("#anar_dl_products_gallery"),o=t.find("#anar_estimate_products_gallery");a.on("click",(function(a){a.preventDefault();var o=e(this),n=o.find(".spinner-loading"),s=t.find(".anar-batch-progress"),r=t.find(".anar-batch-messages"),c=0,l=0,d=0,u="error";!function a(f){e.ajax({url:awca_ajax_object.ajax_url,type:"POST",dataType:"json",data:{action:"anar_dl_products_gallery_ajax",page:f,limit:1,security_nonce:t.find('input[name="security_nonce"]').val(),max_images:t.find('input[name="max_images"]').val()},beforeSend:function(){n.show(),s.show(),r.show(),o.attr("disabled","disabled")},success:function(e){if(e.success){u="success",c+=e.loop_products,l+=e.total_downloaded,1===f&&(d=e.found_products);var t=(c/d*100).toFixed(2)+"%";s.show(),s.find(".bar").animate({width:t},100);var p=c+" محصول از کل "+d+" پردازش شد - "+l+" تصویر دانلود شد.";r.addClass("success").text(p),e.has_more?a(f+1):(r.addClass("success").text("همه محصولات پردازش شدند"),i("همه محصولات پردازش شدند","success"))}else r.addClass("error").text(e.message),n.hide(),o.removeAttr("disabled"),i(e.message,u)},error:function(e,t,a){n.hide(),o.removeAttr("disabled"),i(e.responseText)},complete:function(){n.hide(),o.removeAttr("disabled")}})}(1)})),o.on("click",(function(o){o.preventDefault();var n=e(this),s=n.find(".spinner-loading"),r=t.find(".estimate-messages"),c="error";e.ajax({url:awca_ajax_object.ajax_url,type:"POST",dataType:"json",data:{action:"anar_estimate_products_gallery_ajax",max_images:t.find('input[name="max_images"]').val()},beforeSend:function(){s.show(),r.show(),n.attr("disabled","disabled")},success:function(e){e.success?(c="success",r.addClass("success").html(e.data.message),setTimeout((function(){a.slideDown(300)}),1e3)):(r.addClass("error").html(e.data.message),s.hide(),n.removeAttr("disabled"),i(e.message,c))},error:function(e,t,a){s.hide(),n.removeAttr("disabled"),i(e.responseText)},complete:function(){s.hide(),n.removeAttr("disabled")}})}))}))})()})();